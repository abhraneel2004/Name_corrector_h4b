{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 215, "column": 0}, "map": {"version":3,"sources":["file://D%3A/00_WorkSpace/Hackathon/h4b_online3/Name_corrector_h4b/src/ai/ai-instance.ts"],"sourcesContent":["import {genkit} from 'genkit';\r\nimport {googleAI} from '@genkit-ai/googleai';\r\n\r\n/**\r\n * Logger function for Gemini API calls\r\n * Can be imported and used wherever Gemini API is being used\r\n */\r\nexport function logGeminiAPICall(context: string): void {\r\n  console.log(`🌐 [GEMINI API] ${context}`);\r\n}\r\n\r\n// Create the AI instance\r\nexport const ai = genkit({\r\n  promptDir: './prompts',\r\n  plugins: [\r\n    googleAI({\r\n      apiKey: process.env.GOOGLE_GENAI_API_KEY,\r\n    }),\r\n  ],\r\n  model: 'googleai/gemini-2.0-flash',\r\n});\r\n"],"names":[],"mappings":";;;;AAAA;AAAA;AACA;AAAA;;;AAMO,SAAS,iBAAiB,OAAe;IAC9C,QAAQ,GAAG,CAAC,CAAC,gBAAgB,EAAE,SAAS;AAC1C;AAGO,MAAM,KAAK,CAAA,GAAA,uIAAA,CAAA,SAAM,AAAD,EAAE;IACvB,WAAW;IACX,SAAS;QACP,CAAA,GAAA,2KAAA,CAAA,WAAQ,AAAD,EAAE;YACP,QAAQ,QAAQ,GAAG,CAAC,oBAAoB;QAC1C;KACD;IACD,OAAO;AACT","debugId":null}},
    {"offset": {"line": 243, "column": 0}, "map": {"version":3,"sources":["file://D%3A/00_WorkSpace/Hackathon/h4b_online3/Name_corrector_h4b/src/services/indian-name-validator-server.ts"],"sourcesContent":["/**\r\n * Represents information about a name, including its validity.\r\n */\r\nexport interface NameInfo {\r\n  /**\r\n   * Indicates whether the name is valid or not.\r\n   */\r\n  isValid: boolean;\r\n  /**\r\n   * An optional message providing additional information about the name.\r\n   */\r\n  message?: string;\r\n  /**\r\n   * An optional suggested correction for an invalid name.\r\n   */\r\n  suggestion?: string;\r\n}\r\n\r\n/**\r\n * Represents a name correction entry\r\n */\r\nexport interface NameCorrection {\r\n  /**\r\n   * The original name\r\n   */\r\n  original: string;\r\n  /**\r\n   * The corrected name\r\n   */\r\n  corrected: string;\r\n  /**\r\n   * Whether a correction was made\r\n   */\r\n  needsCorrection: boolean;\r\n  /**\r\n   * Optional reason for the correction\r\n   */\r\n  reason?: string;\r\n}\r\n\r\n// List of common Indian first names and last names for validation\r\nconst commonIndianFirstNames = [\r\n  'Aditya', 'Amit', 'Ananya', 'Arjun', 'Aryan', 'Aishwarya', 'Anil', 'Anjali',\r\n  'Deepa', 'Deepak', 'Divya', 'Gaurav', 'Isha', 'Karan', 'Kavita', 'Krishna',\r\n  'Manish', 'Meera', 'Mohan', 'Neha', 'Nikhil', 'Pooja', 'Priya', 'Rahul',\r\n  'Raj', 'Rajesh', 'Rakesh', 'Ravi', 'Sachin', 'Sanjay', 'Sarika', 'Shikha',\r\n  'Shiv', 'Sneha', 'Sunil', 'Sunita', 'Suresh', 'Tanvi', 'Varun', 'Vijay',\r\n  'Vikram', 'Viren', 'Vivek', 'Yash'\r\n];\r\n\r\nconst commonIndianLastNames = [\r\n  'Agarwal', 'Bansal', 'Bhatia', 'Chauhan', 'Chopra', 'Das', 'Dutta', 'Gandhi',\r\n  'Gupta', 'Jain', 'Joshi', 'Kapoor', 'Khan', 'Kumar', 'Malhotra', 'Mehta',\r\n  'Mishra', 'Nair', 'Patel', 'Rao', 'Reddy', 'Saxena', 'Sharma', 'Singh',\r\n  'Sinha', 'Verma', 'Yadav', 'Iyer', 'Pillai', 'Desai', 'Shah', 'Mukherjee',\r\n  'Chatterjee', 'Bose', 'Banerjee', 'Patil', 'Kaur', 'Mehra', 'Menon', 'Gill'\r\n];\r\n\r\n// Regex patterns for validation\r\nconst nameRegexPattern = /^[A-Za-z\\s.'-]+$/;\r\nconst specialCharPattern = /[^A-Za-z\\s.'-]/;\r\nconst excessiveSpecialCharPattern = /[.'-]{2,}/;\r\n\r\n// Name validation types\r\nexport interface NameValidationResult {\r\n  isValid: boolean;\r\n  name: string;\r\n  confidence: number;\r\n  issues: string[];\r\n  suggestions: string[];\r\n  message?: string;\r\n}\r\n\r\n// Common Indian naming patterns and rules\r\nconst commonIssues = {\r\n  tooShort: 'Name is too short',\r\n  noSpaces: 'Full name should contain at least first and last name',\r\n  incorrectCapitalization: 'Name should be properly capitalized',\r\n  specialCharacters: 'Name contains invalid special characters',\r\n  numbersPresent: 'Name should not contain numbers',\r\n  excessiveSpaces: 'Name contains excessive spaces',\r\n  missingLastName: 'Indian names typically include a last name'\r\n};\r\n\r\n// Basic validation checks\r\nconst validateBasicRules = (name: string): { issues: string[], confidence: number } => {\r\n  const issues: string[] = [];\r\n  let confidence = 100;\r\n  \r\n  // Check name length\r\n  if (name.length < 3) {\r\n    issues.push(commonIssues.tooShort);\r\n    confidence -= 30;\r\n  }\r\n  \r\n  // Check for numbers\r\n  if (/\\d/.test(name)) {\r\n    issues.push(commonIssues.numbersPresent);\r\n    confidence -= 40;\r\n  }\r\n  \r\n  // Check for invalid special characters (allowing periods and hyphens)\r\n  if (/[^a-zA-Z\\u0900-\\u097F\\s.\\-]/u.test(name)) {\r\n    issues.push(commonIssues.specialCharacters);\r\n    confidence -= 30;\r\n  }\r\n  \r\n  // Check for excessive spaces\r\n  if (/\\s{2,}/.test(name)) {\r\n    issues.push(commonIssues.excessiveSpaces);\r\n    confidence -= 15;\r\n  }\r\n  \r\n  // Check for proper capitalization (each name part should be capitalized)\r\n  const nameParts = name.trim().split(/\\s+/);\r\n  const allProperlyCapitalized = nameParts.every(part => \r\n    part.length > 0 && part[0] === part[0].toUpperCase() && part.slice(1) === part.slice(1).toLowerCase()\r\n  );\r\n  \r\n  if (!allProperlyCapitalized) {\r\n    issues.push(commonIssues.incorrectCapitalization);\r\n    confidence -= 20;\r\n  }\r\n  \r\n  // Check for full name (first and last name)\r\n  if (nameParts.length < 2) {\r\n    issues.push(commonIssues.missingLastName);\r\n    confidence -= 15;\r\n  }\r\n  \r\n  return { issues, confidence: Math.max(0, confidence) };\r\n};\r\n\r\n// Generate suggestions for fixing identified issues\r\nconst generateSuggestions = (name: string, issues: string[]): string[] => {\r\n  const suggestions: string[] = [];\r\n  const nameParts = name.trim().split(/\\s+/);\r\n  \r\n  // Fix capitalization\r\n  if (issues.includes(commonIssues.incorrectCapitalization)) {\r\n    const properlyCapitalized = nameParts.map(part => \r\n      part.charAt(0).toUpperCase() + part.slice(1).toLowerCase()\r\n    ).join(' ');\r\n    \r\n    suggestions.push(properlyCapitalized);\r\n  }\r\n  \r\n  // Fix excessive spaces\r\n  if (issues.includes(commonIssues.excessiveSpaces)) {\r\n    const fixedSpaces = name.replace(/\\s+/g, ' ').trim();\r\n    suggestions.push(fixedSpaces);\r\n  }\r\n  \r\n  // If name is missing last name, suggest common Indian last names\r\n  if (issues.includes(commonIssues.missingLastName) && nameParts.length === 1) {\r\n    const commonLastNames = ['Sharma', 'Patel', 'Singh', 'Kumar', 'Verma', 'Rao', 'Reddy', 'Nair', 'Joshi'];\r\n    const firstName = nameParts[0].charAt(0).toUpperCase() + nameParts[0].slice(1).toLowerCase();\r\n    \r\n    // Add 3 random last name suggestions\r\n    for (let i = 0; i < 3; i++) {\r\n      const randomLastName = commonLastNames[Math.floor(Math.random() * commonLastNames.length)];\r\n      suggestions.push(`${firstName} ${randomLastName}`);\r\n    }\r\n  }\r\n  \r\n  return [...new Set(suggestions)]; // Remove duplicates\r\n};\r\n\r\n/**\r\n * Validates an Indian name and returns detailed validation results\r\n * @param name The name to validate\r\n * @returns Validation result with confidence score, issues, and suggestions\r\n */\r\nexport async function validateIndianName(name: string): Promise<NameValidationResult> {\r\n  console.log(`[SERVER] Validating Indian name: \"${name}\"`);\r\n  \r\n  // Basic input validation\r\n  if (!name || typeof name !== 'string') {\r\n    throw new Error('Invalid input: Name must be a non-empty string');\r\n  }\r\n  \r\n  // Trim the name to remove leading/trailing whitespace\r\n  const trimmedName = name.trim();\r\n  \r\n  // Perform our own validation checks\r\n  const { issues, confidence } = validateBasicRules(trimmedName);\r\n  \r\n  // Generate suggestions for improvement\r\n  const suggestions = generateSuggestions(trimmedName, issues);\r\n  \r\n  // Determine if the name is valid based on confidence threshold\r\n  const isValid = confidence > 70;\r\n  \r\n  // Create a summary message from the first issue (if any)\r\n  const message = issues.length > 0 ? issues[0] : isValid ? 'Valid Indian name' : undefined;\r\n  \r\n  const result = {\r\n    isValid,\r\n    name: trimmedName,\r\n    confidence,\r\n    issues,\r\n    suggestions,\r\n    message\r\n  };\r\n  \r\n  console.log(`[SERVER] Validation result for \"${name}\":`, { isValid, confidence, issuesCount: issues.length });\r\n  \r\n  return result;\r\n}\r\n\r\n/**\r\n * Batch validates multiple Indian names or separate first and last names\r\n * @param firstParam Array of names or first names\r\n * @param lastNames Optional array of last names\r\n * @returns Array of validation results or object with first/last name corrections\r\n */\r\nexport async function batchValidateIndianNames(names: string[]): Promise<NameValidationResult[]>;\r\nexport async function batchValidateIndianNames(\r\n  firstNames: string[], \r\n  lastNames: string[]\r\n): Promise<{\r\n  firstNameCorrections: NameCorrection[],\r\n  lastNameCorrections: NameCorrection[]\r\n}>;\r\nexport async function batchValidateIndianNames(\r\n  firstParam: string[],\r\n  secondParam?: string[]\r\n): Promise<NameValidationResult[] | {\r\n  firstNameCorrections: NameCorrection[],\r\n  lastNameCorrections: NameCorrection[]\r\n}> {\r\n  // If only one parameter provided, it's the names array\r\n  if (!secondParam) {\r\n    console.log(`[SERVER] Batch validating ${firstParam.length} names`);\r\n    \r\n    if (!Array.isArray(firstParam)) {\r\n      throw new Error('Invalid input: Names must be provided as an array');\r\n    }\r\n    \r\n    // Process each name in parallel\r\n    const validationPromises = firstParam.map(name => validateIndianName(name));\r\n    const results = await Promise.all(validationPromises);\r\n    \r\n    console.log(`[SERVER] Completed batch validation of ${results.length} names`);\r\n    \r\n    return results;\r\n  }\r\n  \r\n  // Otherwise, we're dealing with firstNames and lastNames\r\n  const firstNames = firstParam;\r\n  const lastNames = secondParam;\r\n  \r\n  console.log(`[SERVER] Batch validating ${firstNames.length} first names and ${lastNames.length} last names`);\r\n  \r\n  // Process first names\r\n  const firstNameCorrections: NameCorrection[] = [];\r\n  for (const name of firstNames) {\r\n    if (!name || name.trim() === '') {\r\n      firstNameCorrections.push({\r\n        original: name,\r\n        corrected: name,\r\n        needsCorrection: false\r\n      });\r\n      continue;\r\n    }\r\n    \r\n    const validation = await validateIndianName(name);\r\n    \r\n    firstNameCorrections.push({\r\n      original: name,\r\n      corrected: validation.suggestions.length > 0 ? validation.suggestions[0] : name,\r\n      needsCorrection: !validation.isValid,\r\n      reason: validation.message\r\n    });\r\n  }\r\n  \r\n  // Process last names\r\n  const lastNameCorrections: NameCorrection[] = [];\r\n  for (const name of lastNames) {\r\n    if (!name || name.trim() === '') {\r\n      lastNameCorrections.push({\r\n        original: name,\r\n        corrected: name,\r\n        needsCorrection: false\r\n      });\r\n      continue;\r\n    }\r\n    \r\n    const validation = await validateIndianName(name);\r\n    \r\n    lastNameCorrections.push({\r\n      original: name,\r\n      corrected: validation.suggestions.length > 0 ? validation.suggestions[0] : name,\r\n      needsCorrection: !validation.isValid,\r\n      reason: validation.message\r\n    });\r\n  }\r\n  \r\n  console.log(`[SERVER] Completed batch validation of ${firstNames.length} first names and ${lastNames.length} last names`);\r\n  \r\n  return {\r\n    firstNameCorrections,\r\n    lastNameCorrections\r\n  };\r\n} "],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 529, "column": 0}, "map": {"version":3,"sources":["file://D%3A/00_WorkSpace/Hackathon/h4b_online3/Name_corrector_h4b/src/ai/flows/audit-data-for-indian-names.ts"],"sourcesContent":["// Audit Indian names in a dataset.\r\n\r\n'use server';\r\n\r\nimport {ai, logGeminiAPICall} from '@/ai/ai-instance';\r\nimport {validateIndianName, batchValidateIndianNames} from '@/services/indian-name-validator-server';\r\nimport {z} from 'genkit';\r\n\r\nconst AuditDataForIndianNamesInputSchema = z.object({\r\n  data: z\r\n    .array(z.record(z.string()))\r\n    .describe('An array of data records, where each record is a map of string to string.'),\r\n});\r\nexport type AuditDataForIndianNamesInput = z.infer<typeof AuditDataForIndianNamesInputSchema>;\r\n\r\nconst AuditDataForIndianNamesOutputSchema = z.object({\r\n  anomalies: z.array(\r\n    z.object({\r\n      row: z.number().describe('The row number where the anomaly was found.'),\r\n      column: z.string().describe('The column name where the anomaly was found.'),\r\n      value: z.string().describe('The value that was flagged as an anomaly.'),\r\n      message: z.string().describe('The reason why the value was flagged as an anomaly.'),\r\n      suggestion: z.string().optional().describe('A suggested correction for the anomaly.'),\r\n    })\r\n  ),\r\n});\r\nexport type AuditDataForIndianNamesOutput = z.infer<typeof AuditDataForIndianNamesOutputSchema>;\r\n\r\nexport async function auditDataForIndianNames(\r\n  input: AuditDataForIndianNamesInput\r\n): Promise<AuditDataForIndianNamesOutput> {\r\n  console.log(\"[SERVER] 🤖 Calling Gemini API for auditDataForIndianNames flow\");\r\n  logGeminiAPICall(`Starting auditDataForIndianNames flow with ${input.data.length} records`);\r\n  \r\n  const result = await auditDataForIndianNamesFlow(input);\r\n  \r\n  console.log(\"[SERVER] 🤖 Gemini API call completed for auditDataForIndianNames flow\");\r\n  logGeminiAPICall(`Completed auditDataForIndianNames flow with ${result.anomalies.length} anomalies`);\r\n  \r\n  return result;\r\n}\r\n\r\nconst auditDataForIndianNamesFlow = ai.defineFlow(\r\n  {\r\n    name: 'auditDataForIndianNamesFlow',\r\n    inputSchema: AuditDataForIndianNamesInputSchema,\r\n    outputSchema: AuditDataForIndianNamesOutputSchema,\r\n  },\r\n  async input => {\r\n    console.log(\"[SERVER] 🤖 Starting Gemini API flow execution\");\r\n    logGeminiAPICall(`Executing AI flow for data auditing - processing data`);\r\n    \r\n    const anomalies: AuditDataForIndianNamesOutput['anomalies'] = [];\r\n\r\n    // Define the name columns to check\r\n    const firstNameColumn = 'Accused First Name';\r\n    const lastNameColumn = 'Accused Last Name';\r\n    const inspectorColumn = 'Inspector In charge';\r\n    \r\n    // Extract all names from each column\r\n    const firstNames: string[] = [];\r\n    const lastNames: string[] = [];\r\n    const inspectorNames: string[] = [];\r\n    \r\n    // Map row indices to keep track of original positions\r\n    const firstNameIndices: number[] = [];\r\n    const lastNameIndices: number[] = [];\r\n    const inspectorIndices: number[] = [];\r\n    \r\n    // Collect all names and their row indices\r\n    for (let i = 0; i < input.data.length; i++) {\r\n      const row = input.data[i];\r\n      \r\n      if (row[firstNameColumn]?.trim()) {\r\n        firstNames.push(row[firstNameColumn]);\r\n        firstNameIndices.push(i);\r\n      }\r\n      \r\n      if (row[lastNameColumn]?.trim()) {\r\n        lastNames.push(row[lastNameColumn]);\r\n        lastNameIndices.push(i);\r\n      }\r\n      \r\n      if (row[inspectorColumn]?.trim()) {\r\n        inspectorNames.push(row[inspectorColumn]);\r\n        inspectorIndices.push(i);\r\n      }\r\n    }\r\n    \r\n    // Process first names and last names in batches\r\n    try {\r\n      console.log(`Processing ${firstNames.length} first names and ${lastNames.length} last names`);\r\n      logGeminiAPICall(`Validating ${firstNames.length} first names and ${lastNames.length} last names`);\r\n      \r\n      const nameValidationResults = await batchValidateIndianNames(\r\n        firstNames, \r\n        lastNames\r\n      );\r\n      \r\n      const { firstNameCorrections, lastNameCorrections } = nameValidationResults;\r\n      \r\n      // Process first name corrections\r\n      for (let i = 0; i < firstNameCorrections.length; i++) {\r\n        const correction = firstNameCorrections[i];\r\n        if (correction.needsCorrection) {\r\n          anomalies.push({\r\n            row: firstNameIndices[i] + 1, // Convert to 1-indexed\r\n            column: firstNameColumn,\r\n            value: correction.original,\r\n            message: correction.reason || 'Name requires correction',\r\n            suggestion: correction.corrected,\r\n          });\r\n        }\r\n      }\r\n      \r\n      // Process last name corrections\r\n      for (let i = 0; i < lastNameCorrections.length; i++) {\r\n        const correction = lastNameCorrections[i];\r\n        if (correction.needsCorrection) {\r\n          anomalies.push({\r\n            row: lastNameIndices[i] + 1, // Convert to 1-indexed\r\n            column: lastNameColumn,\r\n            value: correction.original,\r\n            message: correction.reason || 'Name requires correction',\r\n            suggestion: correction.corrected,\r\n          });\r\n        }\r\n      }\r\n      \r\n      // Process inspector names separately (not in batch)\r\n      for (let i = 0; i < inspectorNames.length; i++) {\r\n        const value = inspectorNames[i];\r\n        console.log(\"value\", value);\r\n        const nameInfo = await validateIndianName(value);\r\n        \r\n        if (!nameInfo.isValid) {\r\n          anomalies.push({\r\n            row: inspectorIndices[i] + 1, // Convert to 1-indexed\r\n            column: inspectorColumn,\r\n            value: value,\r\n            message: nameInfo.message || 'The value is potentially not a valid Indian name.',\r\n            suggestion: nameInfo.suggestions && nameInfo.suggestions.length > 0 ? nameInfo.suggestions[0] : '',\r\n          });\r\n        }\r\n      }\r\n    } catch (error) {\r\n      console.error(\"Error in batch name validation:\", error);\r\n      logGeminiAPICall(`Error during name validation: ${error instanceof Error ? error.message : String(error)}`);\r\n      \r\n      // Fallback to individual validation in case of batch error\r\n      console.log(\"Falling back to individual name validation\");\r\n      for (let i = 0; i < input.data.length; i++) {\r\n        const row = input.data[i];\r\n        \r\n        // Only check name columns\r\n        const nameColumns = [firstNameColumn, lastNameColumn, inspectorColumn];\r\n        \r\n        for (const column of nameColumns) {\r\n          if (Object.prototype.hasOwnProperty.call(row, column)) {\r\n            const value = row[column];\r\n            \r\n            // Skip empty values\r\n            if (!value || value.trim() === '') continue;\r\n            \r\n            console.log(\"value\", value);\r\n            const nameInfo = await validateIndianName(value);\r\n            \r\n            if (!nameInfo.isValid) {\r\n              anomalies.push({\r\n                row: i + 1,\r\n                column: column,\r\n                value: value,\r\n                message: nameInfo.message || 'The value is potentially not a valid Indian name.',\r\n                suggestion: nameInfo.suggestions && nameInfo.suggestions.length > 0 ? nameInfo.suggestions[0] : '',\r\n              });\r\n            }\r\n          }\r\n        }\r\n      }\r\n    }\r\n\r\n    logGeminiAPICall(`AI flow completed - found ${anomalies.length} anomalies`);\r\n    return {anomalies};\r\n  }\r\n);\r\n"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 697, "column": 0}, "map": {"version":3,"sources":["file://D%3A/00_WorkSpace/Hackathon/h4b_online3/Name_corrector_h4b/src/ai/flows/provide-data-audit-summary.ts"],"sourcesContent":["'use server';\r\n/**\r\n * @fileOverview Summarizes potential data quality issues after an audit.\r\n *\r\n * - provideDataAuditSummary - A function that provides a textual summary of potential data issues.\r\n * - ProvideDataAuditSummaryInput - The input type for the provideDataAuditSummary function.\r\n * - ProvideDataAuditSummaryOutput - The return type for the provideDataAuditSummary function.\r\n */\r\n\r\nimport {ai} from '@/ai/ai-instance';\r\nimport {z} from 'genkit';\r\n\r\nconst ProvideDataAuditSummaryInputSchema = z.object({\r\n  auditResults: z.string().describe('The detailed results from the data audit.'),\r\n});\r\nexport type ProvideDataAuditSummaryInput = z.infer<typeof ProvideDataAuditSummaryInputSchema>;\r\n\r\nconst ProvideDataAuditSummaryOutputSchema = z.object({\r\n  summary: z.string().describe('A textual summary of the potential data quality issues.'),\r\n});\r\nexport type ProvideDataAuditSummaryOutput = z.infer<typeof ProvideDataAuditSummaryOutputSchema>;\r\n\r\nexport async function provideDataAuditSummary(input: ProvideDataAuditSummaryInput): Promise<ProvideDataAuditSummaryOutput> {\r\n  return provideDataAuditSummaryFlow(input);\r\n}\r\n\r\nconst prompt = ai.definePrompt({\r\n  name: 'provideDataAuditSummaryPrompt',\r\n  input: {\r\n    schema: z.object({\r\n      auditResults: z.string().describe('The detailed results from the data audit.'),\r\n    }),\r\n  },\r\n  output: {\r\n    schema: z.object({\r\n      summary: z.string().describe('A textual summary of the potential data quality issues.'),\r\n    }),\r\n  },\r\n  prompt: `You are an AI assistant who summarizes data audit results.\r\n\r\n  Given the following data audit results, provide a concise textual summary of the potential data quality issues identified. Focus on the key findings and potential implications for data accuracy and reliability.\r\n  \\n  Audit Results: {{{auditResults}}}\r\n  \\n  Summary: `,\r\n});\r\n\r\nconst provideDataAuditSummaryFlow = ai.defineFlow<\r\n  typeof ProvideDataAuditSummaryInputSchema,\r\n  typeof ProvideDataAuditSummaryOutputSchema\r\n>(\r\n  {\r\n    name: 'provideDataAuditSummaryFlow',\r\n    inputSchema: ProvideDataAuditSummaryInputSchema,\r\n    outputSchema: ProvideDataAuditSummaryOutputSchema,\r\n  },\r\n  async input => {\r\n    const {output} = await prompt(input);\r\n    return output!;\r\n  }\r\n);\r\n"],"names":[],"mappings":";;;;;AACA;;;;;;CAMC,GAED;AACA;AAAA;;;;;;AAEA,MAAM,qCAAqC,uIAAA,CAAA,IAAC,CAAC,MAAM,CAAC;IAClD,cAAc,uIAAA,CAAA,IAAC,CAAC,MAAM,GAAG,QAAQ,CAAC;AACpC;AAGA,MAAM,sCAAsC,uIAAA,CAAA,IAAC,CAAC,MAAM,CAAC;IACnD,SAAS,uIAAA,CAAA,IAAC,CAAC,MAAM,GAAG,QAAQ,CAAC;AAC/B;AAGO,eAAe,uCAAqB,GAArB,wBAAwB,KAAmC;IAC/E,OAAO,4BAA4B;AACrC;AAEA,MAAM,SAAS,2HAAA,CAAA,KAAE,CAAC,YAAY,CAAC;IAC7B,MAAM;IACN,OAAO;QACL,QAAQ,uIAAA,CAAA,IAAC,CAAC,MAAM,CAAC;YACf,cAAc,uIAAA,CAAA,IAAC,CAAC,MAAM,GAAG,QAAQ,CAAC;QACpC;IACF;IACA,QAAQ;QACN,QAAQ,uIAAA,CAAA,IAAC,CAAC,MAAM,CAAC;YACf,SAAS,uIAAA,CAAA,IAAC,CAAC,MAAM,GAAG,QAAQ,CAAC;QAC/B;IACF;IACA,QAAQ,CAAC;;;;eAII,CAAC;AAChB;AAEA,MAAM,8BAA8B,2HAAA,CAAA,KAAE,CAAC,UAAU,CAI/C;IACE,MAAM;IACN,aAAa;IACb,cAAc;AAChB,GACA,OAAM;IACJ,MAAM,EAAC,MAAM,EAAC,GAAG,MAAM,OAAO;IAC9B,OAAO;AACT;;;IAnCoB;;AAAA,+OAAA","debugId":null}},
    {"offset": {"line": 762, "column": 0}, "map": {"version":3,"sources":["file://D%3A/00_WorkSpace/Hackathon/h4b_online3/Name_corrector_h4b/src/ai/flows/suggest-data-corrections.ts"],"sourcesContent":["'use server';\r\n/**\r\n * @fileOverview This file defines a Genkit flow for suggesting corrections to Indian names.\r\n *\r\n * - suggestDataCorrections - A function that initiates the name correction suggestion process.\r\n * - SuggestDataCorrectionsInput - The input type for the suggestDataCorrections function, including the array of names.\r\n * - SuggestDataCorrectionsOutput - The return type for the suggestDataCorrections function, providing suggestions for name corrections.\r\n */\r\n\r\nimport {ai, logGeminiAPICall} from '@/ai/ai-instance';\r\nimport {z} from 'genkit';\r\n\r\n// Define the name correction type\r\ninterface NameCorrection {\r\n  originalName: string;\r\n  suggestedName: string;\r\n  hasCorrection: boolean;\r\n  reason?: string;\r\n}\r\n\r\nconst SuggestDataCorrectionsInputSchema = z.object({\r\n  names: z.array(z.string()).describe('An array of Indian names to be validated and corrected.'),\r\n});\r\nexport type SuggestDataCorrectionsInput = z.infer<typeof SuggestDataCorrectionsInputSchema>;\r\n\r\nconst SuggestDataCorrectionsOutputSchema = z.object({\r\n  correctionResults: z.array(\r\n    z.object({\r\n      originalName: z.string().describe('The original name.'),\r\n      suggestedName: z.string().describe('The suggested correction or original name if no correction needed.'),\r\n      hasCorrection: z.boolean().describe('Whether a correction was made.'),\r\n      reason: z.string().optional().describe('The reason for the correction.'),\r\n    })\r\n  ).describe('An array of name corrections with detailed information.')\r\n});\r\nexport type SuggestDataCorrectionsOutput = z.infer<typeof SuggestDataCorrectionsOutputSchema>;\r\n\r\nexport async function suggestDataCorrections(input: SuggestDataCorrectionsInput): Promise<SuggestDataCorrectionsOutput> {\r\n  try {\r\n    logGeminiAPICall(`Starting name correction flow for ${input.names.length} names`);\r\n    \r\n    // Print input names to console\r\n    console.log('📥 INPUT NAMES:', JSON.stringify(input.names, null, 2));\r\n    \r\n    // Convert the input array to a JSON string for the prompt\r\n    const namesObject = {\r\n      names: input.names\r\n    };\r\n    const namesJson = JSON.stringify(namesObject, null, 2);\r\n    \r\n    const result = await suggestDataCorrectionsFlow({\r\n      namesJson\r\n    });\r\n    \r\n    // Print output corrections to console\r\n    console.log('📤 OUTPUT CORRECTIONS:', JSON.stringify(result.correctionResults, null, 2));\r\n    \r\n    logGeminiAPICall(`Completed name correction flow with ${result.correctionResults.length} results`);\r\n    return result;\r\n  } catch (error) {\r\n    // Log the error but don't try to call toast here\r\n    console.error('Error in name correction flow:', error);\r\n    \r\n    // Return a valid response with empty corrections\r\n    return {\r\n      correctionResults: []\r\n    };\r\n  }\r\n}\r\n\r\nconst prompt = ai.definePrompt({\r\n  name: 'suggestIndianNameCorrectionsPrompt',\r\n  input: {\r\n    schema: z.object({\r\n      namesJson: z.string().describe('JSON string containing an array of Indian names.'),\r\n    }),\r\n  },\r\n  output: {\r\n    schema: z.object({\r\n      correctionResults: z.array(\r\n        z.object({\r\n          originalName: z.string(),\r\n          suggestedName: z.string(),\r\n          hasCorrection: z.boolean(),\r\n          reason: z.string().optional(),\r\n        })\r\n      ),\r\n    }),\r\n  },\r\n  prompt: `You are an AI assistant specialized in Indian name validation and correction.\r\n\r\nYou are provided with a JSON string containing an array of Indian names. Your task is to:\r\n1. Parse the JSON string into an object\r\n2. For each name in the array, check if there are any spelling mistakes or formatting issues\r\n3. Generate a correction if needed, keeping the cultural context of Indian names intact\r\n4. Provide the reason for any correction made\r\n\r\nCommon issues with Indian names include:\r\n- Incorrect capitalization (e.g., \"rahul sharma\" should be \"Rahul Sharma\")\r\n- Missing spaces between first and last names\r\n- Misspelled common Indian names\r\n- Incorrect placement of syllables\r\n\r\nIMPORTANT RULES:\r\n- If the name is already correct, suggest the same name and set hasCorrection to false\r\n- Always respect the cultural integrity of the name\r\n- Look for common Indian first and last names as reference\r\n- Maintain the same general structure of the name unless there's a clear error\r\n- Do not change naming conventions across regions (South Indian vs North Indian naming patterns)\r\n\r\nInput JSON:\r\n{{{namesJson}}}\r\n\r\nPlease provide your analysis and corrections in the following JSON format:\r\n{\r\n  \"correctionResults\": [\r\n    {\r\n      \"originalName\": \"original name\",\r\n      \"suggestedName\": \"corrected name\",\r\n      \"hasCorrection\": true/false,\r\n      \"reason\": \"explanation for correction (if applicable)\"\r\n    },\r\n    ...\r\n  ]\r\n}\r\n`,\r\n});\r\n\r\nconst suggestDataCorrectionsFlowSchema = z.object({\r\n  namesJson: z.string().describe('JSON string containing an array of Indian names.'),\r\n});\r\n\r\nconst suggestDataCorrectionsFlow = ai.defineFlow<\r\n  typeof suggestDataCorrectionsFlowSchema,\r\n  typeof SuggestDataCorrectionsOutputSchema\r\n>(\r\n  {\r\n    name: 'suggestDataCorrectionsFlow',\r\n    inputSchema: suggestDataCorrectionsFlowSchema,\r\n    outputSchema: SuggestDataCorrectionsOutputSchema,\r\n  },\r\n  async input => {\r\n    logGeminiAPICall(`Processing names through Gemini API`);\r\n    console.log('🔄 PROCESSING: Sending input to Gemini API:', input.namesJson);\r\n    \r\n    const {output} = await prompt(input);\r\n    \r\n    console.log('✅ RECEIVED: Response from Gemini API:', JSON.stringify(output, null, 2));\r\n    return output!;\r\n  }\r\n);\r\n"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 898, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"","debugId":null}},
    {"offset": {"line": 965, "column": 0}, "map": {"version":3,"sources":["file://D%3A/00_WorkSpace/Hackathon/h4b_online3/Name_corrector_h4b/src/app/page.tsx/proxy.mjs"],"sourcesContent":["import { registerClientReference } from \"react-server-dom-turbopack/server.edge\";\nexport default registerClientReference(\n    function() { throw new Error(\"Attempted to call the default export of [project]/src/app/page.tsx <module evaluation> from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.\"); },\n    \"[project]/src/app/page.tsx <module evaluation>\",\n    \"default\",\n);\n"],"names":[],"mappings":";;;AAAA;;uCACe,CAAA,GAAA,qPAAA,CAAA,0BAAuB,AAAD,EACjC;IAAa,MAAM,IAAI,MAAM;AAAoR,GACjT,kDACA","debugId":null}},
    {"offset": {"line": 979, "column": 0}, "map": {"version":3,"sources":["file://D%3A/00_WorkSpace/Hackathon/h4b_online3/Name_corrector_h4b/src/app/page.tsx/proxy.mjs"],"sourcesContent":["import { registerClientReference } from \"react-server-dom-turbopack/server.edge\";\nexport default registerClientReference(\n    function() { throw new Error(\"Attempted to call the default export of [project]/src/app/page.tsx from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.\"); },\n    \"[project]/src/app/page.tsx\",\n    \"default\",\n);\n"],"names":[],"mappings":";;;AAAA;;uCACe,CAAA,GAAA,qPAAA,CAAA,0BAAuB,AAAD,EACjC;IAAa,MAAM,IAAI,MAAM;AAAgQ,GAC7R,8BACA","debugId":null}},
    {"offset": {"line": 993, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"","debugId":null}}]
}